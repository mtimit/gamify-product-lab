<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–¢–µ—Å—Ç - Gamify Product Lab</title>
  <style>
    body {
      font-family: system-ui;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
    }
    .test-section {
      background: #111827;
      padding: 16px;
      margin: 16px 0;
      border-radius: 8px;
    }
    .status {
      padding: 8px;
      margin: 8px 0;
      border-radius: 4px;
    }
    .success { background: #22c55e; color: #022c22; }
    .error { background: #ef4444; color: white; }
    .info { background: #3b82f6; color: white; }
  </style>
</head>
<body>
  <h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Gamify Product Lab</h1>
  
  <div class="test-section">
    <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π</h2>
    <div id="module-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
  </div>

  <div class="test-section">
    <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage</h2>
    <div id="storage-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
  </div>

  <div class="test-section">
    <h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤</h2>
    <div id="dom-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
  </div>

  <div class="test-section">
    <h2>4. –†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
    <div id="final-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
  </div>

  <script type="module">
    let allTestsPassed = true;

    // –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π
    try {
      const { createInitialState } = await import('./src/models.js');
      const { loadState, saveState } = await import('./src/storage.js');
      const { awardXpForAction } = await import('./src/gameLogic.js');
      
      document.getElementById('module-status').innerHTML = 
        '<div class="status success">‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ</div>';
      
      // –¢–µ—Å—Ç 2: localStorage
      const testState = createInitialState();
      saveState(testState);
      const loadedState = loadState();
      
      if (loadedState && loadedState.version === "1.0") {
        document.getElementById('storage-status').innerHTML = 
          '<div class="status success">‚úÖ localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç</div>';
      } else {
        throw new Error('localStorage –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ');
      }

      // –¢–µ—Å—Ç 3: DOM
      setTimeout(() => {
        const response = window.open('index.html', '_blank');
        document.getElementById('dom-status').innerHTML = 
          '<div class="status info">‚ÑπÔ∏è –û—Ç–∫—Ä—ã—Ç–∞ –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)</div>';
      }, 500);

    } catch (error) {
      allTestsPassed = false;
      document.getElementById('module-status').innerHTML = 
        `<div class="status error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
      document.getElementById('storage-status').innerHTML = 
        '<div class="status error">‚ùå –¢–µ—Å—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω</div>';
      document.getElementById('dom-status').innerHTML = 
        '<div class="status error">‚ùå –¢–µ—Å—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω</div>';
    }

    // –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
    setTimeout(() => {
      if (allTestsPassed) {
        document.getElementById('final-status').innerHTML = 
          '<div class="status success">‚úÖ –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã! –û—Ç–∫—Ä–æ–π—Ç–µ index.html –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)</div>';
      } else {
        document.getElementById('final-status').innerHTML = 
          '<div class="status error">‚ùå –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã—à–µ.</div>';
      }
    }, 1000);
  </script>
</body>
</html>